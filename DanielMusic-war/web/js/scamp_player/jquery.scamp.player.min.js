!function(t){t.ScampPlayer=function(s,a){var e={sm_options:{},queue:null,iscroll_options:{scrollX:!1,scrollY:!0,mouseWheel:!0,scrollbars:!0,interactiveScrollbars:!0,scrollbars:"custom",click:!0},volume:100,autoplay:!1,loop:!1,random:!1,titlebar:!1,no_track_image:null,delay:5,path:null,client_id:"23f5c38e0aa354cdd0e1a6b4286f6aa4",debug:!1,link_filter:".track-title",labels:{play:"Play",cover:"Cover",title:"Title/Artist",buy:"Buy",remove:"Remove"},obj:{status:"ready",action:"",tracks:[],tracks_size:0,track_nr:-1},mobile:!1,status:null,soundcloud:!1,track_id:0,new_tracks_nr:0,new_tracks_notifications:!0,sm_init:!1,rebuild:!1,sound:null,track:null,searching:!1,tracklist_length:null,document_title:document.title,track_html:null,tracklist:null,onReady:function(){},onTrackEnd:function(){},onTrackStart:function(){}},r=this;r.settings={};var n=function(){r.settings=t.extend({},e,a),r.el=s,window.soundManager&&(sm_obj={onready:function(){if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(r.settings.mobile=!0),r.settings.mobile&&(r.settings.autoplay=!1),r.settings.mobile&&null!=r.settings.path){t("body").append('<div id="scamp-mobile-init"></div>');var s=soundManager.createSound({id:"init_mobile_track",url:r.settings.path+"/blank.mp3",autoload:!1,volume:10,onload:function(){},onplay:function(){},onpause:function(){},onresume:function(){},onstop:function(){},onfinish:function(){},whileloading:function(){},whileplaying:function(){}});t("#scamp-mobile-init").on("touchstart click mousemove",function(){s.play(),t(this).remove()})}"undefined"!=typeof SC&&(SC.initialize({client_id:r.settings.client_id}),SC.whenStreamingReady(function(){r.settings.soundcloud=!0})),r.settings.sm_init=!0;var a=null;if(t("> a",r.el).length){a=new Array;var e=t("> a",r.el).length;t("> a",r.el).each(function(){a.push(t(this)),t(this).remove()})}if(r.el.append('<div id="sp-toggle-wrap"><div id="sp-toggle"></div></div><div class="sp-main-container"><div class="sp-queue-container" style="padding-bottom: 0px; height: 414px; padding-left: 0px; padding-right: 0px;"><div class="sp-queue"><div id="sp-scroller"><table id="sp-queue-scroll"></table></div></div><div class="sp-progress-mobile"><div class="sp-progress"><span class="sp-loading"></span><span class="sp-position"></span><span class="sp-time-elapsed"></span><span class="sp-time-total"></span></div></div></div><div class="sp-player-container"><div class="sp-buttons-container"><div class="sp-controls"><a class="sp-prev-button"></a><a class="sp-play-button"></a><a class="sp-next-button"></a><div class="sp-volume-container"><div class="sp-volume-bar-container"><div class="sp-volume-slider"><span class="sp-volume-position"></span></div></div><a class="sp-volume-button"></a></div></div><div class="sp-queue-button-container"><span class="sp-badge"></span><a class="sp-queue-button"></a></div></div><div class="sp-progress-container"><div class="sp-progress"><span class="sp-loading"></span><span class="sp-position"></span><span class="sp-time-elapsed"></span><span class="sp-time-total"></span></div></div><div class="sp-track-container"><div class="sp-track-details"><a class="sp-track-cover"><img src="'+r.settings.no_track_image+'" alt="Track cover" class="sp-track-artwork"/></a><a class="sp-track-title" style="margin-top: 3px;"></a><a class="sp-track-artist"></a><div class="sp-marquee-container"><span class="sp-marquee"></span></div></div></div></div></div>'),r.settings.track_html=['<tr class="sp-track">','<td><a class="sp-track-control sp-icon" href="#"></a></td>','<td class="sp-cover-artwork"><img src="" alt="Cover" /></td>','<td class="sp-title"><a class="sp-title-button"></a><a class="sp-artist-button"></a></td>','<td class="sp-cart sp-small-screen"><a class="sp-icon sp-cart-button"></a></td>','<td class="sp-remove sp-small-screen sp-medium-screen"><span class="sp-icon sp-remove-button"></span></td>'].join("\n"),r.settings.tracklist=t("#sp-queue-scroll"),"undefined"==typeof IScroll)return!1;if(r.settings.queue=new IScroll("#sp-scroller",r.settings.iscroll_options),t(r.el).hasClass("sp-show-list")&&_set_queue_height(),t(".sp-volume-position").css("width",r.settings.volume+"%"),_set_vol_class(r.settings.volume),!r.settings.mobile){var n=function(s){t(".sp-volume-bar-container").fadeToggle(200,"swing"),r.el.removeClass("sp-show-list"),s.preventDefault(),s.stopPropagation()};t(".sp-volume-button").on("click",n),t(document).click(function(s){var a=t(".sp-volume-bar-container");a.is(s.target)||0!==a.has(s.target).length||(t(".sp-volume-button").off("click"),t(".sp-volume-bar-container").fadeOut(200,"swing",function(){t(".sp-volume-button").on("click",n)}))})}null!==a&&(r.settings.obj={status:"working",action:"add_tracks",tracks:a,tracks_size:e,track_nr:-1},g()),t(".sp-play-button").on("touchstart click",o),t(".sp-next-button").on("touchstart click",c),t(".sp-prev-button").on("touchstart click",u),t(".sp-queue-button").on("touchstart click",function(t){r.el.toggleClass("sp-show-list"),_set_queue_height(),t.preventDefault()}),t("#sp-toggle").on("touchstart click",function(t){r.el.toggleClass("sp-show-player"),t.preventDefault()}),b(),r.update_events("body"),r.el.addClass("sp-show"),r.settings.onReady.call(void 0)},ontimeout:function(){},defaultOptions:{volume:r.settings.volume,usePeakData:!1}},t.extend(r.settings.sm_options,sm_obj),soundManager.setup(r.settings.sm_options))};_set_queue_height=function(){var s=t(".sp-player-container",r.el).outerHeight(),a=(t(".sp-progress-mobile ",r.el).outerHeight(),t(window).height());return t(".sp-progress-mobile",r.el).is(":visible")?a-=2*s:(a-=s,s=0),t(".sp-queue-container",r.el).css("padding-bottom",s),t(".sp-queue-container",r.el).height(a),setTimeout(function(){r.settings.queue.refresh()},200),a},t(window).on("resize",_set_queue_height),_get_track_index=function(){var s,a=r.settings.track.find(".sp-track-control").attr("href");return track_from_queue=t("#sp-queue-scroll").find('.sp-track-control[href="'+a+'"]'),s=track_from_queue.parents('tr[class*="sp-track"]').index()};var i=function(){var s=r.settings.track.find(".sp-track-control").attr("href");r.settings.sound=soundManager.createSound({id:"scamp_sound",url:s,autoload:!1,volume:r.settings.volume,onload:function(){},onplay:function(){var s={title:r.settings.track.find(".sp-title-button").text(),url:r.settings.track.find(".sp-track-control").attr("href"),artist:r.settings.track.find(".sp-artist-button").text(),track_index:_get_track_index(),tracklist_length:r.settings.tracklist_length};r.settings.onTrackStart.call(this,s),3==r.settings.sound.readyState?r.settings.status="play":(r.settings.track.addClass("loading"),r.el.addClass("loading"),r.settings.status="loading"),r.update_content(),t(".sp-volume-position").css("width",r.settings.volume+"%"),r.settings.sound.setVolume(r.settings.volume)},onpause:function(){r.settings.status="pause",r.update_content(),r.settings.searching||(r.settings.track.removeClass("playing").addClass("paused"),r.el.removeClass("playing").addClass("paused"))},onresume:function(){r.settings.status="play",r.update_content(),r.settings.track.removeClass("paused").addClass("playing"),r.el.removeClass("paused").addClass("playing")},onstop:function(){r.settings.sound.setPosition(0),r.settings.status="stop",r.update_content(),r.settings.track.removeClass("playing loading paused"),r.el.removeClass("playing loading paused"),t(".sp-time-elapsed, .sp-time-total").empty(),t(".sp-progress").find(".sp-position").width(0)},onfinish:function(){var s={title:r.settings.track.find(".sp-title-button").text(),url:r.settings.track.find(".sp-track-control").attr("href"),artist:r.settings.track.find(".sp-artist-button").text(),track_index:_get_track_index(),tracklist_length:r.settings.tracklist_length};if(r.settings.onTrackEnd.call(this,s),t(".sp-time-elapsed, .sp-time-total").empty(),t(".sp-progress").find(".sp-position").width(0),r.settings.status="stop",r.update_content(),r.settings.track.removeClass("loading paused"),r.el.removeClass("loading paused"),r.settings.random)return l(),!1;if(r.settings.loop)c();else{var a=_get_track_index();if(a!=r.settings.tracklist_length)c();else{r.settings.track.removeClass("playing"),r.el.removeClass("playing");var e=document.location.hash,n=r.settings.track.find(".sp-track-control").attr("href");r.grabTrack(e,n)}}},whileloading:function(){t(".sp-progress").find(".sp-loading").width(r.settings.sound.bytesLoaded/r.settings.sound.bytesTotal*100+"%")},whileplaying:function(){r.settings.track.removeClass("paused loading").addClass("playing"),r.el.removeClass("paused loading").addClass("playing"),r.settings.status="play",r.update_content(),t(".sp-progress").find(".sp-position").width(r.settings.sound.position/r.settings.sound.durationEstimate*100+"%"),t(".sp-time-elapsed").html(_format_time(r.settings.sound.position)),t(".sp-time-total").html(_format_time(r.settings.sound.durationEstimate))}}),r.settings.sound.togglePause(),p()};r.grabTrack=function(t,s){url="./MusicController?target=GrabASong",$.ajax({type:"GET",async:!1,url:url,dataType:"text",data:{pageURL:t,mp3URL:s},success:function(t){var s=JSON.parse(t),a={artist:s.artist,title:s.title,url:"http://sounds.sg.storage.googleapis.com/"+s.url,cover:"http://sounds.sg.storage.googleapis.com/"+s.cover,artist_url:"javascript:_artistLookup("+s.artistID+")",shop_url:"javascript:_addTrackToCart("+s.musicID+")"};r.addTrack(a,"play_tracks")},error:function(t,s,a){hideLoader(),ajaxResultsError(t,s,a)}})},_artistLookup=function(t){url="./MusicController?target=GetArtistByID",$.ajax({type:"GET",async:!1,url:url,data:{id:t},dataType:"text",success:function(t){var s=JSON.parse(t);s.result&&(window.location.href="#!/artists")},error:function(t,s,a){document.getElementById("errMsg").style.display="block",document.getElementById("errMsg").innerHTML=a,hideLoader(),ajaxResultsError(t,s,a)}})},_addTrackToCart=function(t){url="./MusicManagementController?target=AddTrackToShoppingCart",$.ajax({type:"GET",async:!1,url:url,data:{trackID:t},success:function(){window.location.href="#!/cart"},error:function(t,s,a){document.getElementById("errMsg").style.display="block",document.getElementById("errMsg").innerHTML=a,hideLoader(),ajaxResultsError(t,s,a)}})};var o=function(){return null!=r.settings.tracklist_length?(null==r.settings.track&&(r.settings.track=t("#sp-queue-scroll tbody tr:eq(0)")),r.settings.sound?r.settings.sound.togglePause():i(),r.settings.titlebar&&(document.title=r.settings.track.find(".sp-title-button").text()+" | "+r.settings.document_title),!1):void 0},l=function(){function s(t,s){return Math.floor(Math.random()*(s-t+1))+t}if(null==r.settings.tracklist_length||r.settings.tracklist_length<2)return r.settings.track=e,o(),!1;for(var a=_get_track_index(),e=null,n=null;(n=s(0,r.settings.tracklist_length))==a;);return r.settings.track.removeClass("playing"),r.el.removeClass("playing"),e=t("#sp-queue-scroll tbody tr:eq("+n+")"),_destruct_sound(),r.settings.track=e,o(),r.settings.sound&&r.settings.sound.setPosition(0),!0},c=function(){if(null!=r.settings.tracklist_length){var s=_get_track_index(),a=s+1,e=null,n=!1;return r.el.hasClass("playing")&&(r.settings.track.removeClass("playing"),r.el.removeClass("playing"),n=!0),a>r.settings.tracklist_length&&(a=0),e=t("#sp-queue-scroll tbody tr:eq("+a+")"),_destruct_sound(),r.settings.track=e,n&&o(),r.settings.sound&&r.settings.sound.setPosition(0),!1}},u=function(){if(null!=r.settings.tracklist_length){var s=_get_track_index(),a=s-1,e=null,n=!1;return r.el.hasClass("playing")&&(r.settings.track.removeClass("playing"),r.el.removeClass("playing"),n=!0),0>a&&(a=r.settings.tracklist_length),e=t("#sp-queue-scroll tbody tr:eq("+a+")"),_destruct_sound(),r.settings.track=e,n&&o(),r.settings.sound&&r.settings.sound.setPosition(0),!1}},d=function(){return null!=r.settings.tracklist_length?(null==r.settings.track&&(r.settings.track=t("#sp-queue-scroll tbody tr:eq(0)")),r.settings.sound&&r.settings.sound.stop(),!1):void 0},p=function(){if(t(".sp-track-container a",r.el).removeAttr("href").removeAttr("target"),t(".sp-track-container .sp-track-title, .sp-track-container .sp-track-artist",r.el).text(""),t(".sp-track-container .sp-track-artwork",r.el).attr("src",r.settings.no_track_image),t(".sp-marquee",r.el).text(""),r.settings.sound){var s=r.settings.track.find(".sp-cover-artwork img").attr("src"),a=r.settings.track.find(".sp-title-button").text(),e=r.settings.track.find(".sp-artist-button").text(),n=r.settings.track.find(".sp-artist-button").attr("href"),i=r.settings.track.find(".sp-artist-button").attr("target"),o=r.settings.track.find(".sp-title-button").attr("href"),l=r.settings.track.find(".sp-title-button").attr("target");shop_url=r.settings.track.find(".sp-tl-shop").attr("href"),shop_target=r.settings.track.find(".sp-tl-shop").attr("target"),""!==e&&""!==n&&(t(".sp-track-container .sp-track-artist",r.el).attr("href",n),i=""!==i?i:"_self",t(".sp-track-container .sp-track-artist",r.el).attr("target",i)),""!==o&&(t(".sp-track-container .sp-track-title",r.el).attr("href",o),l=""!==l?l:"_self",t(".sp-track-container .sp-track-title",r.el).attr("target",l)),t(".sp-track-container .sp-track-artwork",r.el).attr("src",s),t(".sp-track-container .sp-track-title",r.el).text(a),t(".sp-track-container .sp-track-artist",r.el).text(e);var c="<strong>"+a+"</strong>";""!==e&&(c=c+" - "+e),t(".sp-marquee",r.el).html(c)}return!1};_destruct_sound=function(){r.settings.sound&&(r.settings.sound.stop(),r.settings.sound.setPosition(0),r.settings.sound.destruct(),r.settings.sound=null,p())};var g=function(){r.settings.obj.track_nr++,0==r.settings.obj.track_nr&&(r.el.addClass("sp-queue-loading"),t(".sp-queue").css("opacity",0)),r.settings.obj.track_nr>=r.settings.obj.tracks_size?k():setTimeout(_,r.settings.delay)},k=function(){var s=null,a=null,e=null;if(t("#sp-scroller tr").length>0&&r.settings.rebuild?(_set_queue_height(),r.el.removeClass("sp-queue-loading"),t(".sp-queue").css("opacity",1),r.settings.rebuild=!1,r.settings.new_tracks_notifications&&(t(".sp-badge",r.el).text("+"+r.settings.new_tracks_nr),"+0"!=t(".sp-badge",r.el).text()&&(t(".sp-badge",r.el).addClass("sp-show-badge"),setTimeout(function(){t(".sp-badge",r.el).removeClass("sp-show-badge")},5e3))),r.settings.new_tracks_nr=0):(r.el.removeClass("sp-queue-loading"),t(".sp-queue").css("opacity",1)),null!=r.settings.track&&r.settings.autoplay&&(r.settings.random?l():o(),r.settings.autoplay=!1),"play_track"==r.settings.obj.action||"play_tracks"==r.settings.obj.action)for(var n=0;n<r.settings.obj.tracks_size;n++)if(s=r.settings.obj.tracks[n].data("status"),e=r.settings.obj.tracks[n].attr("href"),"track_ready"==s||"already_onlist"==s){if(a=r.settings.track.find(".sp-track-control").attr("href"),a!=e){_destruct_sound();var i=t("#sp-queue-scroll").find('.sp-track-control[href="'+e+'"]');r.settings.track=i.parents('tr[class*="sp-track"]')}o();break}r.settings.obj.status="ready"},_=function(){var s=r.settings.obj.track_nr,a=r.settings.obj.tracks[s].attr("href"),e=/http(s?):\/\/soundcloud/;if(e.test(a))if(t('.sp-queue .sp-track[data-sc="'+a+'"]').length>0){r.settings.obj.tracks[s].attr("data-status","already_onlist");var n=t('#sp-queue-scroll tbody .sp-track[data-sc="'+a+'"]');n=n.find(".sp-track-control").attr("href"),r.settings.obj.tracks[s].attr("href",n),g()}else _add_soundcloud();else t('.sp-queue .sp-track-control[href="'+a+'"]').length>0?(r.settings.obj.tracks[s].attr("data-status","already_onlist"),g()):""!=a||"#"!=a||void 0!=a?(r.settings.obj.tracks[s].attr("data-status","file_exists"),_create_track()):(r.settings.obj.tracks[s].attr("data-status","Error404"),g())};_add_soundcloud=function(){var t=r.settings.obj.track_nr,s=r.settings.obj.tracks[t].attr("href");if(""==r.settings.client_id)return r.settings.obj.tracks[t].attr("data-status","Error404"),g(),!1;if(!r.settings.soundcloud)return r.settings.obj.tracks[t].attr("data-status","Error404"),g(),!1;if(void 0!=r.settings.obj.tracks[t].data("sc_stream")){var a={stream_url:null,artwork_url:null,title:null,permalink_url:null,user:{username:null,permalink_url:null}};return a.stream_url=r.settings.obj.tracks[t].data("sc_stream"),a.artwork_url=r.settings.obj.tracks[t].data("sc_art"),a.title=r.settings.obj.tracks[t].data("sc_title"),a.user.username=r.settings.obj.tracks[t].data("artist"),a.user.permalink=r.settings.obj.tracks[t].data("artist_url"),a.permalink=r.settings.obj.tracks[t].data("release_url"),_create_soundcloud(a),!1}SC.get("/resolve",{url:s},function(s){void 0!=s.length&&(s.tracks=s),s.errors?(r.settings.obj.tracks[t].attr("data-status","Error404"),g()):void 0!=s.kind&&"user"==s.kind?SC.get("/users/"+s.id+"/tracks",function(t){t.tracks=t,_process_sc_tracks(t)}):void 0!=s.kind&&"group"==s.kind?SC.get("/groups/"+s.id+"/tracks",function(t){t.tracks=t,_process_sc_tracks(t)}):s.tracks?_process_sc_tracks(s):_create_soundcloud(s)})},_process_sc_tracks=function(s){var a=r.settings.obj.track_nr,e=r.settings.obj.tracks[a].attr("href"),n=a,i=[],o=r.settings.obj.tracks[a].attr("data-artist"),l=r.settings.obj.tracks[a].attr("data-artist_url"),c=r.settings.obj.tracks[a].attr("data-artist_target"),u=r.settings.obj.tracks[a].attr("data-release_url"),d=r.settings.obj.tracks[a].attr("data-release_target");shop_url=r.settings.obj.tracks[a].attr("data-shop_url"),shop_target=r.settings.obj.tracks[a].attr("data-shop_target"),r.settings.obj.tracks.splice(a,1),r.settings.obj.tracks_size=r.settings.obj.tracks_size-1,r.settings.obj.track_nr=r.settings.obj.track_nr-1,(void 0==shop_url||""==shop_url)&&(shop_url=""),(void 0==shop_target||""==shop_target)&&(shop_target=""),t.each(s.tracks,function(s,a){var r,n,p,g,k;r=void 0==o||""==o?a.user.username:o,void 0==l||""==l?(n=a.user.permalink_url,p="_blank"):(n=l,p=void 0==c||""==c?"_blank":c),void 0==u||""==u?(g=a.permalink_url,k="_blank"):(g=u,k=void 0==d||""==d?"_blank":d);var _='<a href="'+a.permalink_url+'" data-cover="" data-sc_list="'+e+'" data-sc_stream="'+a.stream_url+'" data-sc_art="'+a.artwork_url+'" data-sc_title="'+a.title+'" data-artist="'+r+'" data-artist_url="'+n+'" data-artist_target="'+p+'" data-release_url="'+g+'" data-release_target="'+k+'" data-shop_url="'+shop_url+'" data-shop_target="'+shop_target+'">'+a.title+"</a>";i.push(t(_))}),_insert_array_at(r.settings.obj.tracks,n,i),r.settings.obj.tracks_size=r.settings.obj.tracks_size+i.length,g()},_insert_array_at=function(t,s,a){return Array.prototype.splice.apply(t,[s,0].concat(a)),t},_create_soundcloud=function(t){var s=r.settings.obj.track_nr,a=r.settings.obj.tracks[s].attr("href"),e=t.stream_url,n=r.settings.obj.tracks[s].attr("data-artist"),i=r.settings.obj.tracks[s].attr("data-artist_url"),o=r.settings.obj.tracks[s].attr("data-artist_target"),l=r.settings.obj.tracks[s].attr("data-release_url"),c=r.settings.obj.tracks[s].attr("data-release_target");return void 0===e?(console.log("Soundcloud error: No stream URL!"),r.settings.obj.tracks[s].attr("data-status","Error404"),g(),!1):(e+=-1==e.indexOf("secret_token")?"?":"&",e=e+"consumer_key="+r.settings.client_id,(void 0==n||""==n)&&(n=t.user.username),(void 0==i||""==i)&&(i=t.user.permalink_url),(void 0==o||""==o)&&(o="_blank"),(void 0==l||""==l)&&(l=t.permalink_url),(void 0==c||""==c)&&(c="_blank"),r.settings.obj.tracks[s].attr("data-sc",a),r.settings.obj.tracks[s].attr("href",e),r.settings.obj.tracks[s].attr("data-cover",t.artwork_url),r.settings.obj.tracks[s].attr("data-artist",n),r.settings.obj.tracks[s].attr("data-artist_url",i),r.settings.obj.tracks[s].attr("data-artist_target",o),r.settings.obj.tracks[s].attr("data-release_url",l),r.settings.obj.tracks[s].attr("data-release_target",c),r.settings.obj.tracks[s].text(t.title),void _create_track())},_create_track=function(){r.settings.rebuild=!0;var s=r.settings.obj.track_nr,a=r.settings.obj.tracks[s].attr("href"),e=r.settings.obj.tracks[s].text(),n=r.settings.obj.tracks[s].data("cover"),i=r.settings.obj.tracks[s].data("artist"),o=r.settings.obj.tracks[s].data("artist_url"),l=r.settings.obj.tracks[s].data("artist_target"),c=r.settings.obj.tracks[s].data("release_url"),u=r.settings.obj.tracks[s].data("release_target"),d=r.settings.obj.tracks[s].data("shop_url"),p=r.settings.obj.tracks[s].data("shop_target"),k=t(r.settings.track_html),_=null;if(t('.sp-queue .sp-track-control[href="'+a+'"]',r.el).length)return r.settings.obj.tracks[s].attr("data-status","already_onlist"),g(),!1;if(k.find(".sp-track-control").attr("href",a),(void 0==n||""==n)&&(n=r.settings.no_track_image),k.find(".sp-cover-artwork img").attr("src",n),k.find(".sp-title-button").text(e),(void 0!=c||""!=c)&&(k.find(".sp-title-button").attr("href",c),(void 0!=u||""!=u)&&k.find(".sp-title-button").attr("target",u)),void 0!=i&&""!=i&&(k.find(".sp-artist-button").text(i),(void 0!=o||""!=o)&&(k.find(".sp-artist-button").attr("href",o),void 0!=l&&""!=l&&k.find(".sp-artist-button").attr("target",l))),void 0!=d&&""!=d?(k.find(".sp-cart-button").attr("href",d),void 0!=p&&""!=p&&k.find(".sp-cart-button").attr("target",p)):k.find(".sp-cart-button").remove(),void 0!=r.settings.obj.tracks[s].data("sc")){var h=r.settings.obj.tracks[s].data("sc");k.attr("data-sc",h).addClass("sc-track")}if(void 0!=r.settings.obj.tracks[s].data("sc_list")){var b=r.settings.obj.tracks[s].data("sc_list");k.attr("data-sc_list",b).addClass("sc-list")}r.settings.tracklist.append(k),_=r.settings.tracklist.find(k),r.settings.track_id++,r.settings.new_tracks_nr++,r.settings.tracklist_length=t("#sp-queue-scroll tbody .sp-track").length-1,0==r.settings.tracklist_length&&(r.settings.track=_),r.settings.obj.tracks[s].attr("data-status","track_ready"),_.find(".sp-track-control").on("click",f),_.find(".sp-remove-button").on("click",v),g()};var f=function(s){s.preventDefault();var a=t(this).parents('tr[class*="sp-track"]');return a.hasClass("playing")||a.hasClass("paused")?(o(),!1):(_destruct_sound(),r.settings.track=a,o(),!1)},v=function(s){s.preventDefault();var a=t(this).parents('tr[class*="sp-track"]'),e=t(this).parents('tr[class*="sp-track"]').index(),n=null,i=!1;if(a.hasClass("playing")&&(i=!0),r.settings.sound&&(n=r.settings.sound.url),0==r.settings.tracklist_length)return _destruct_sound(),r.settings.track=null,r.settings.tracklist_length=null,void h(0);if(n==a.find(".sp-track-control ").attr("href")){var l=e,c=l+1,u=null;c>r.settings.tracklist_length&&(c=0),u=t("#sp-queue-scroll tbody tr:eq("+c+")"),i?(_destruct_sound(),r.settings.track=u,o()):_destruct_sound()}h(e),r.settings.tracklist_length=t("#sp-queue-scroll tbody .sp-track").length-1},h=function(s){return t("#sp-scroller tr").length>0&&r.settings.tracklist.find("tbody tr:eq("+s+")").remove(),!1},b=function(){var s="ontouchstart"in window,a=s?"touchstart":"mousedown",e=s?"touchmove":"mousemove",n=s?"touchend":"mouseup";t(".sp-volume-slider").on(a,function(a){if(null!=r.settings.tracklist_length){var i=t(this),o=i.find(".sp-volume-position"),l=i.offset().left,c=i.width(),u=r.settings.sound,d=null;return t(document).on(e,function(t){var a=s?t.originalEvent.touches[0]:t,e=Math.max(0,Math.min(a.clientX-l,c));return d=Math.floor(e/c*100),o.width(e),u&&u.setVolume(d),_set_vol_class(d),!1}).on(n,function(){return r.settings.volume=d,t(this).unbind(e),t(this).unbind(n),!1}).trigger({type:e,clientX:a.clientX}),!1}}),t(".sp-progress").bind(a,function(a){if(null!=r.settings.tracklist_length){var i=t(this).addClass("searching"),o=i.find(".sp-postion"),l=i.offset().left,c=i.width(),u=r.settings.sound;return r.settings.searching=!0,u.pause(),t(document).bind(e,function(t){var a=s?t.originalEvent.touches[0]:t,e=Math.max(0,Math.min(a.clientX-l,c));return o.width(e),u&&u.setPosition(e/c*u.durationEstimate),!1}).bind(n,function(){return r.settings.searching=!1,i.removeClass("searching"),r.el.hasClass("playing")&&u&&u.resume(),t(this).unbind(e),t(this).unbind(n),!1}).trigger({type:e,clientX:a.clientX}),!1}})};_set_vol_class=function(s){0==s?t(".sp-volume-button").removeClass("sp-vol-medium sp-vol-max").addClass("sp-vol-off"):50>=s?t(".sp-volume-button").removeClass("sp-vol-max sp-vol-off").addClass("sp-vol-medium"):s>75&&t(".sp-volume-button").removeClass("sp-vol-medium sp-vol-off").addClass("sp-vol-max")},_format_time=function(t){var s=Math.floor(t/1e3),a=Math.floor(s/60),e=s-60*a;return a+":"+(10>e?"0"+e:e)},_pretty_link=function(s){var a="",e="",n=s.attr("href"),i=s.data("cover"),o=s.data("artist"),l=s.data("artist_url"),c=s.data("artist_target"),u=s.data("release_url"),d=s.data("release_target"),p=s.data("shop_url"),g=s.data("shop_target");return void 0!=r.settings.link_filter&&""!=r.settings.link_filter&&t(s).find(r.settings.link_filter).length&&(e=t(s).find(r.settings.link_filter).text()),i=void 0==i||""==i?"":'data-cover="'+i+'"',o=void 0==o||""==o?"":'data-artist="'+o+'"',l=void 0==l||""==l?"":'data-artist_url="'+l+'"',c=void 0==c||""==c?"":'data-artist_target="'+c+'"',u=void 0==u||""==u?"":'data-release_url="'+u+'"',d=void 0==d||""==d?"":'data-release_target="'+d+'"',p=void 0==p||""==p?"":'data-shop_url="'+p+'"',g=void 0==g||""==g?"":'data-shop_target="'+g+'"',a='<a href="'+n+'" '+i+" "+o+" "+l+" "+c+" "+u+" "+d+" "+p+" "+g+">"+e+"</a>",a=t(a)},_add_track=function(s){if(s.preventDefault(),"#"==t(this).attr("href")||""==t(this).attr("href"))return!1;if("working"==r.settings.obj.status)return!1;var a=_pretty_link(t(this)),e=[a];return r.settings.obj={status:"working",action:"add_track",tracks:e,tracks_size:1,track_nr:-1},g(),!1},_play_track=function(s){if(s.preventDefault(),"#"==t(this).attr("href")||""==t(this).attr("href"))return!1;if("working"==r.settings.obj.status)return!1;var a=_pretty_link(t(this)),e=[a];return r.settings.mobile,r.settings.obj={status:"working",action:"play_track",tracks:e,tracks_size:1,track_nr:-1},g(),!1},_add_tracks=function(s){s.preventDefault();var a=t(this).data("id");if(void 0==a||""==a||t("#"+a).length<=0)return!1;if("working"==r.settings.obj.status)return!1;var e=t("#"+a),n=new Array,i=t("a.sp-add-track, a.sp-play-track",e).length;t("a.sp-add-track, a.sp-play-track",e).each(function(){n.push(_pretty_link(t(this)))}),r.settings.obj={status:"working",action:"add_tracks",tracks:n,tracks_size:i,track_nr:-1},g()},_play_tracks=function(s){s.preventDefault();var a=t(this).data("id");if(void 0==a||""==a||t("#"+a).length<=0)return!1;if("working"==r.settings.obj.status)return!1;var e=t("#"+a),n=new Array,i=t("a.sp-add-track, a.sp-play-track",e).length;t("a.sp-add-track, a.sp-play-track",e).each(function(){n.push(_pretty_link(t(this)))}),r.settings.mobile,r.settings.obj={status:"working",action:"play_tracks",tracks:n,tracks_size:i,track_nr:-1},g()},_debug=function(s){r.settings.debug&&t("#scamp-console").append(s+"<br>")},r.update_events=function(s){t(s).off("click",".sp-add-track",_add_track),t(s).off("click",".sp-play-track",_play_track),t(s).off("click",".sp-add-list",_add_tracks),t(s).off("click",".sp-play-list",_play_tracks),t(s).on("click",".sp-add-track",_add_track),t(s).on("click",".sp-play-track",_play_track),t(s).on("click",".sp-add-list",_add_tracks),t(s).on("click",".sp-play-list",_play_tracks)},r.update_content=function(){var s=r.settings.track,a=null;if(null!=s){t("a.sp-play-track").removeClass("sp-play sp-pause sp-stop sp-loading"),a=s.hasClass("sc-list")?s.data("sc_list"):s.hasClass("sc-track")?s.data("sc"):s.find(".sp-track-control").attr("href");var e=t('a.sp-play-track[href="'+a+'"]');if(e.length>0)switch(r.settings.status){case"loading":e.addClass("sp-loading");break;case"play":e.addClass("sp-play");break;case"pause":e.addClass("sp-pause");break;case"stop":e.addClass("sp-stop")}}},r.addTrack=function(s,a){if("working"==r.settings.obj.status)return!1;if("undefined"==typeof s)return!1;var s=t('<a href="'+s.url+'" data-cover="'+s.cover+'" data-artist="'+s.artist+'" data-artist_url="'+s.artist_url+'" data-artist_target="'+s.artist_target+'" data-release_url="'+s.release_url+'" data-release_target="'+s.release_target+'" data-shop_url="'+s.shop_url+'" data-shop_target="'+s.shop_target+'">'+s.title+"</a>"),e=[s];return r.settings.obj={status:"working",action:a,tracks:e,tracks_size:1,track_nr:-1},g(),!1},r.addTracks=function(s,a){if("working"==r.settings.obj.status)return!1;if("undefined"==typeof s||0==s.length)return!1;for(var e=new Array,n=s.length,i=0,o=n;o>i;i++){var l=t('<a href="'+s[i].url+'" data-cover="'+s[i].cover+'" data-artist="'+s[i].artist+'" data-artist_url="'+s[i].artist_url+'" data-artist_target="'+s[i].artist_target+'" data-release_url="'+s[i].release_url+'" data-release_target="'+s[i].release_target+'" data-shop_url="'+s[i].shop_url+'" data-shop_target="'+s[i].shop_target+'">'+s[i].title+"</a>");e.push(l)}r.settings.obj={status:"working",action:a,tracks:e,tracks_size:n,track_nr:-1},g()},r.playerAction=function(t){return"working"==r.settings.obj.status?!1:void("play"==t?o():"stop"==t?d():"next"==t?c():"prev"==t&&u())},n()}}(jQuery);